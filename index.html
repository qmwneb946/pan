<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub ç½‘ç›˜</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <style>
        body { padding: 20px; max-width: 800px; margin: auto; }
        .file-list { list-style: none; padding: 0; }
        .file-list li { padding: 10px; border-bottom: 1px solid #ddd; display: flex; align-items: center; }
        .file-list i { margin-right: 10px; }
        .back-btn { display: none; }
    </style>
</head>
<body>

    <h2 class="text-center">ðŸ“‚ æˆ‘çš„ GitHub ç½‘ç›˜</h2>
    <button class="btn btn-secondary back-btn" onclick="goBack()">â¬… è¿”å›žä¸Šä¸€çº§</button>
    <ul class="file-list" id="file-list">æ­£åœ¨åŠ è½½æ–‡ä»¶...</ul>

    <script>
        const repo = "qmwneb946/pan"; // ä¿®æ”¹ä¸ºä½ çš„ä»“åº“
        const branch = "main"; // ä»“åº“åˆ†æ”¯
        let currentPath = "files"; // åˆå§‹ç›®å½•

        async function fetchFiles(path) {
            const url = `https://api.github.com/repos/${repo}/contents/${path}?ref=${branch}`;
            try {
                let response = await fetch(url);
                let files = await response.json();

                let list = document.getElementById("file-list");
                list.innerHTML = ""; // æ¸…ç©ºå†…å®¹

                // å¦‚æžœå½“å‰ç›®å½•ä¸æ˜¯æ ¹ç›®å½•ï¼Œæ˜¾ç¤ºè¿”å›žæŒ‰é’®
                if (path !== "files") {
                    document.querySelector(".back-btn").style.display = "block";
                } else {
                    document.querySelector(".back-btn").style.display = "none";
                }

                files.forEach(file => {
                    let li = document.createElement("li");
                    let link = document.createElement("a");
                    link.style = "text-decoration: none; color: black;";
                    
                    if (file.type === "dir") {
                        // è¿›å…¥æ–‡ä»¶å¤¹
                        link.href = "#";
                        link.onclick = () => { currentPath = file.path; fetchFiles(file.path); };
                        link.innerHTML = `<i class="fas fa-folder text-warning"></i> ${file.name}`;
                    } else {
                        // ä¸‹è½½æ–‡ä»¶
                        link.href = file.download_url;
                        link.target = "_blank";
                        let sizeKB = (file.size / 1024).toFixed(1);
                        link.innerHTML = `<i class="fas fa-file text-primary"></i> ${file.name} <span class="text-muted">(${sizeKB} KB)</span>`;
                    }

                    li.appendChild(link);
                    list.appendChild(li);
                });
            } catch (error) {
                document.getElementById("file-list").innerText = "æ— æ³•åŠ è½½æ–‡ä»¶åˆ—è¡¨";
            }
        }

        function goBack() {
            let parts = currentPath.split("/");
            parts.pop();
            currentPath = parts.length > 1 ? parts.join("/") : "files";
            fetchFiles(currentPath);
        }

        fetchFiles(currentPath);
    </script>

</body>
</html>
